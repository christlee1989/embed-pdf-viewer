<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EmbedPDF</title>
  <style>
    html, body { overscroll-behavior: none; }
    body {
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <div id="pdf-viewer" style="height: 100dvh"></div>
  <script async type="module">
    import EmbedPDF from './embedpdf.js';
    import { getOptimalConfig } from './performance-config.js';
    const wasmUrl = new URL("./pdfium.wasm", import.meta.url).href;
    const pdfUrl = new URL("./ceshi.pdf", import.meta.url).href;

    // 获取设备信息并选择最优配置
    const deviceInfo = {
      memory: navigator.deviceMemory,
      cores: navigator.hardwareConcurrency,
      connection: navigator.connection?.effectiveType === 'slow-2g' || 
                 navigator.connection?.effectiveType === '2g' ? 'slow' : 'fast'
    };
    console.log('### deviceInfo ###', deviceInfo);

    const performanceConfig = getOptimalConfig(deviceInfo);

    const EPDFinstance = EmbedPDF.init({
      type: 'container',
      target: document.getElementById('pdf-viewer'),
      src: pdfUrl,
      worker: true,
      wasmUrl,
      ...performanceConfig,
      plugins: {
        scroll: {
          initialPage: 1,
        },
      },
    })
  </script>
</body>
</html>
